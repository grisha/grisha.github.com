<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>How Data Points Build Up | Gregory Trubetskoy</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="This silly SVG animation (animation not my strong suit) demonstrates
what happens when multiple Tgres data points arrive within the same
step (i.e. smallest time interval for this series, also known as PDP,
primary data point).

  You browser does not support SVG objects?

Explanation
Let&rsquo;s say we have a series with a step of 100 seconds. We receive the
following data points, all within the 100 second interval of a
single step:">
    <meta name="generator" content="Hugo 0.146.0">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    <meta name="author" content="Gregory Trubetskoy">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >




    


    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/blog/2016/08/04/how-data-points-build-up/">
    

    
    
    <meta property="og:url" content="http://localhost:1313/blog/2016/08/04/how-data-points-build-up/">
  <meta property="og:site_name" content="Gregory Trubetskoy">
  <meta property="og:title" content="How Data Points Build Up">
  <meta property="og:description" content="This silly SVG animation (animation not my strong suit) demonstrates what happens when multiple Tgres data points arrive within the same step (i.e. smallest time interval for this series, also known as PDP, primary data point).
You browser does not support SVG objects? Explanation Let’s say we have a series with a step of 100 seconds. We receive the following data points, all within the 100 second interval of a single step:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2016-08-04T10:35:00+00:00">
    <meta property="article:modified_time" content="2016-08-04T10:35:00+00:00">

  <meta itemprop="name" content="How Data Points Build Up">
  <meta itemprop="description" content="This silly SVG animation (animation not my strong suit) demonstrates what happens when multiple Tgres data points arrive within the same step (i.e. smallest time interval for this series, also known as PDP, primary data point).
You browser does not support SVG objects? Explanation Let’s say we have a series with a step of 100 seconds. We receive the following data points, all within the 100 second interval of a single step:">
  <meta itemprop="datePublished" content="2016-08-04T10:35:00+00:00">
  <meta itemprop="dateModified" content="2016-08-04T10:35:00+00:00">
  <meta itemprop="wordCount" content="575">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="How Data Points Build Up">
  <meta name="twitter:description" content="This silly SVG animation (animation not my strong suit) demonstrates what happens when multiple Tgres data points arrive within the same step (i.e. smallest time interval for this series, also known as PDP, primary data point).
You browser does not support SVG objects? Explanation Let’s say we have a series with a step of 100 seconds. We receive the following data points, all within the 100 second interval of a single step:">

	
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'] ],
      displayMath: [ ['$$', '$$']],
      processEscapes: true,
    },
    messageStyle: "none",
    "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l center items-center justify-between">
    <a href="/" class="f3 fw2 hover-white white-90 dib no-underline">
      
        Gregory Trubetskoy
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/archives/" title="Archives page">
              Archives
            </a>
          </li>
          
        </ul>
      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l mw7 center ph3 flex-wrap justify-between">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">How Data Points Build Up</h1>
      
      <p class="tracked"><strong>Gregory Trubetskoy</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2016-08-04T10:35:00Z">August 4, 2016</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-100-l"><p>This silly SVG animation (animation not my strong suit) demonstrates
what happens when multiple Tgres data points arrive within the same
step (i.e. smallest time interval for this series, also known as PDP,
primary data point).</p>
<object data="/images/data_point.svg" type="image/svg+xml">
  You browser does not support SVG objects?
</object>
<h3 id="explanation">Explanation</h3>
<p>Let&rsquo;s say we have a series with a step of 100 seconds. We receive the
following data points, all within the 100 second interval of a
single step:</p>
<table>
  <thead>
      <tr>
          <th>Time</th>
          <th>Value</th>
          <th>Recorded</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>25s</td>
          <td>2.0</td>
          <td>0.5</td>
      </tr>
      <tr>
          <td>75s</td>
          <td>3.0</td>
          <td>2.0</td>
      </tr>
      <tr>
          <td>100s</td>
          <td>1.0</td>
          <td>2.25</td>
      </tr>
      <tr>
          <td>&mdash;&mdash;-</td>
          <td>&mdash;&mdash;-</td>
          <td>&mdash;&mdash;&mdash;-</td>
      </tr>
      <tr>
          <td></td>
          <td>Final:</td>
          <td>2.25</td>
      </tr>
  </tbody>
</table>
<p/> Tgres will store 2.25 as the final value for this step. So how
does 1, 2 and 3 add up to _2.25_?
<p>One way to think about it is that the incomplete step is an empty
swimming pool as wide as 1 step, into which we dump blocks of
water. The first data point dumps a 2.0 × 0.25 block of water, which
fills the pool to 0.5. The second data point dumps a 3.0 × 0.50 block,
which raises the water another 1.5 to 2.0. The last data point dumps a
1.0 × 0.25 block which raises it to the final value of 2.25.  Compare
this with Graphite which would simply discard the first two data
points and we are left with 1.0 as the final value.</p>
<p>Why is it done this way? Because this is how rates add up. If this was
speed of a car in meters per second (more like a bycicle, I guess),
its weighted average speed for the duration of this step of 2.25
meters per second would mean that in the 100s it would have traveled
exactly 225 meters.</p>
<h3 id="nans-or-unknowns">NaNs or &ldquo;Unknowns&rdquo;</h3>
<p>What if instead of the first data point, the first 25s were &ldquo;unknown&rdquo;
(recorded as NaN)? This would happen, for example, if the series
heartbeat (maximum duration without any data) was exceeded. Even
though the data point has a value of 2.0, it gets recorded as NaN.</p>
<table>
  <thead>
      <tr>
          <th>Time</th>
          <th>Value</th>
          <th>Recorded</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>25s</td>
          <td>2.0</td>
          <td>NaN</td>
      </tr>
      <tr>
          <td>75s</td>
          <td>3.0</td>
          <td>2.0</td>
      </tr>
      <tr>
          <td>100s</td>
          <td>1.0</td>
          <td>2.33</td>
      </tr>
      <tr>
          <td>&mdash;&mdash;-</td>
          <td>&mdash;&mdash;-</td>
          <td>&mdash;&mdash;&mdash;-</td>
      </tr>
      <tr>
          <td></td>
          <td>Final:</td>
          <td>2.33</td>
      </tr>
  </tbody>
</table>
<p/>
But wait a second... 0.50 &times; 3 + 0.25 &times; 1 = 1.75 ? Where did
the value of 2.33 come from?
<p>The reason for this is that NaN ought not be influencing the
value. The above calculation would only be correct if we assumed that NaN is
synonymous with zero, but that would be a false assumption, as NaN
means &ldquo;we do not know&rdquo;.</p>
<p>Therefore, we must only consider the known part of the data point,
which is 75s. We can think of it that the data point (the &ldquo;swimming
pool&rdquo;) just got smaller.  Thus the correct calculation for the 3.0
point would be 3.0 × 50 ÷ 75 = 2.0 and for the 1.0 point
2.0 + 1.0 × 25 ÷ 75 = 2.33.</p>
<p>Here it is in SVG:</p>
<object data="/images/data_point_unk.svg" type="image/svg+xml">
  You browser does not support SVG objects?
</object>
<p>Also note how the value of the data point which was recorded as NaN
(2.0 in our example) is essentially irrelevant. This is because any
calculation with a NaN always results in a NaN. The only thing we know
about this data point is that it was not NaN and that it marked the
end of period recorded as NaN. The next data point after this (3.0 in
our example) is not affected by the NaN, however, this is because it
in effect starts its own data point afresh, not considering anything
in the past.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div></article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href="http://localhost:1313/" >
    &copy;  Gregory Trubetskoy 2026 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
