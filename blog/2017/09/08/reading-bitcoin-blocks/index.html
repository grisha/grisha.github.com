<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Reading Bitcoin blocks | Gregory Trubetskoy</title>
<meta name="keywords" content="">
<meta name="description" content="gories:
If by now you&rsquo;re not curious about Bitcoin, then, well, let&rsquo;s just say
you&rsquo;re a little behind the times. Bitcoin is not a fad, and if you
think it has no intrinsic value, you just do not understand how it
works.
Bitcoin, or, more generally, the notion that something that holds all
the properties of a currency can be generated by using large amounts
of electricity and traded using cryptography is a reality, and one
that will transform the world in ways that we cannot quite imagine. If
you think the Internet was disruptive, you haven&rsquo;t seen anything yet.">
<meta name="author" content="Gregory Trubetskoy">
<link rel="canonical" href="http://localhost:1313/blog/2017/09/08/reading-bitcoin-blocks/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/blog/2017/09/08/reading-bitcoin-blocks/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'] ],
      displayMath: [ ['$$', '$$']],
      processEscapes: true,
    },
    messageStyle: "none",
    "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Gregory Trubetskoy (Alt + H)">Gregory Trubetskoy</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Reading Bitcoin blocks
    </h1>
    <div class="post-meta"><span title='2017-09-08 16:41:00 +0000 UTC'>September 8, 2017</span>&nbsp;·&nbsp;<span>Gregory Trubetskoy</span>

</div>
  </header> 
  <div class="post-content"><h2 id="gories">gories:<a hidden class="anchor" aria-hidden="true" href="#gories">#</a></h2>
<p>If by now you&rsquo;re not curious about Bitcoin, then, well, let&rsquo;s just say
you&rsquo;re a little behind the times. Bitcoin is not a fad, and if you
think it has no intrinsic value, you just do not understand how it
works.</p>
<p>Bitcoin, or, more generally, the notion that something that holds all
the properties of a currency can be generated by using large amounts
of electricity and traded using cryptography is a reality, and one
that will transform the world in ways that we cannot quite imagine. If
you think the Internet was disruptive, you haven&rsquo;t seen anything yet.</p>
<p>The first thing that everyone needs to know about Bitcoin (I&rsquo;m
sticking with &ldquo;Bitcoin&rdquo; here, even if all this applies to
&ldquo;crypto-currencies&rdquo; in general.) is that it is not as simple as one
might think. This isn&rsquo;t any different from how most people in general
do not understand accounting, or law, or medicine, and need to refer
to a specialist. What&rsquo;s different is that a CPA doesn&rsquo;t know
everything that applies to Bitcoin, nor does a computer scientist or a
cryptographer or an economist or a quant. Each knows a substantial
piece of the puzzle, but Bitcoin is at an intersection of many
disciplines and the world need new kinds of specialists.</p>
<p>There are things that are very complex but &ldquo;just work&rdquo; that few people
need to know, e.g. wireless data transmission. We can use our cell
phones without knowing the physics of what makes it work. But this
does not apply to Bitcoin. Anyone who claims to know how it works I
believe needs to understand all aspects of it, including elliptic
curve cryptography and secure hashing algorithms, etc.</p>
<h3 id="how-to-learn-bitcoin">How to Learn Bitcoin<a hidden class="anchor" aria-hidden="true" href="#how-to-learn-bitcoin">#</a></h3>
<p>The best way to learn how Bitcoin works (as a software developer, that
is) is to write some code to read the blockchain. You can see my
attempt at it <a href="https://github.com/blkchain/blkchain">here</a>, and I will
write about it in more detail separately.</p>
<h3 id="some-literally-million-dollar-questions">Some (literally) million dollar questions.<a hidden class="anchor" aria-hidden="true" href="#some-literally-million-dollar-questions">#</a></h3>
<p>Some aspects of what crypto-currencies are are still not very well
understood. Here is a list of thins that I would like answered
definitively, but I am not exactly sure how. In no particular order.</p>
<h3 id="dag-based-blockchains">DAG-based blockchains<a hidden class="anchor" aria-hidden="true" href="#dag-based-blockchains">#</a></h3>
<p>There are a few coins out there that claim that a DAG is a better
structure than a blockchain. At least one even makes a claim that
Proof of Work is not necessary. I am at this point leaning towards the
opinion that they are sadly mistaken. The Bitcoin blockchain is
actually a DAG, and blocks are an optimization because without blocks
we&rsquo;d need an insane number of SHA hashes computed every time a
transaction is verified. Proof of work is absolutely essential, it is
what makes it truly scarce, because thus far we have not figured out a
way to produce unlimited computational capability and quite likely
never will.</p>
<h3 id="proof-of-work-vs-proof-of-stake">Proof-of-Work vs Proof-of-Stake<a hidden class="anchor" aria-hidden="true" href="#proof-of-work-vs-proof-of-stake">#</a></h3>
<p>I already touched on this above. I think the idea that a currency can
be backed by its own value is flawed. I might be wrong, but that&rsquo;s my
most current opinion.</p>
<h3 id="is-bitcoin-a-store-of-value-or-an-exchange-medium">Is Bitcoin a Store of Value or an exchange medium?<a hidden class="anchor" aria-hidden="true" href="#is-bitcoin-a-store-of-value-or-an-exchange-medium">#</a></h3>
<p>In other words, will crypto currencies revolutionize the world of
commerce by eliminating the need for credit cards and fiat currencies
we all know and love? I don&rsquo;t think so. I think that if there is a
niche that Bitcoin fills at this point, it is the store of value and
the ability to turn that value into a fiat currency more efficiently
that just about anything else, without the need to for intermediaries,
or at least not as many as with stocks, gold or bonds.</p>
<h3 id="altcoins">Altcoins<a hidden class="anchor" aria-hidden="true" href="#altcoins">#</a></h3>
<p>If anyone can create a coin similar to Bitcoin, doesn&rsquo;t that mean that
Bitcoin can be infinitely diluted by other competing
crypto-currencies? No. And the reasoning goes back to
Proof-Of-Work. Generating coing and verifying transaction requires
lots of energy, which is best spent towards the most established and
popular currency, not an alternative. This is another argument for why
PoW is absolutely necessary.</p>
<h3 id="eventual-price-of-btc">Eventual price of BTC<a hidden class="anchor" aria-hidden="true" href="#eventual-price-of-btc">#</a></h3>
<p>Are we going to see million dollar bitcoins? I think it&rsquo;s entirely
plausible. If you suspect it&rsquo;s &ldquo;too good to be true&rdquo;, consider that a
lot of why this might actually happen is not so much the value of
Bitcoin (it&rsquo;s not going to get any more valueable with time in real
terms), but rather because of accelerating inflation of fiat. But I
can&rsquo;t say I understand this aspect of it very well, and I don&rsquo;t think
anyone does at this point. We can also see Bitcoin tumble, please be
careful.</p>
<h3 id="regulation-of-bitcoin-and-others">Regulation of Bitcoin and others<a hidden class="anchor" aria-hidden="true" href="#regulation-of-bitcoin-and-others">#</a></h3>
<p>It&rsquo;s a matter of time. Much of it is already regulated under the rules
governing securities and exchange, commerce and taxes, and many laws
will be adjusted to be more suitable to Bitcoin and other crypto
currencies. If you think that crypto currencies are an anarchist&rsquo;s
dream come true, you are mistaken. Yet some aspects cannot be
controlled by definition, e.g. no government can ever control the
supply of it, which is what makes it very disruptive.</p>
<h3 id="initial-coin-offerings-ico">Initial Coin Offerings (ICO)<a hidden class="anchor" aria-hidden="true" href="#initial-coin-offerings-ico">#</a></h3>
<p>Unlike Bitcoin, ICO&rsquo;s are a fad and most of them are illegal
scams. Even when they are not scams, they are most likely violating
securities regulation already in place, and it&rsquo;s just a matter of time
before they become effectively illegal.</p>
<h3 id="taxes">Taxes<a hidden class="anchor" aria-hidden="true" href="#taxes">#</a></h3>
<p>Tax laws will need some adjustments since there is no way to tell from
looking at the blockchain when a Bitcoin was acquired or sold, because
transfering a Bitcoin from one wallet to another owned by the same
person is not a taxable event.</p>
<p>What beter way is there to learn all about it then to try to write
some Go code to shove the entire blockchain into Postgres?</p>
<p>This may be a totally futile endeavor, but that only makes it more
fun.</p>
<p>To witness the great american eclipse, ee spent a week on the beaches
of South Carolina, and while there I started tinkering on a possibly
totally useless exercise of shoving the entire blockchain into Postgres.</p>
<p>I can&rsquo;t really say whether indeed it was useless until I finish it,
and it turned out to be considerably more involved than I realized
initially.</p>
<p>My plan is approximately like this:</p>
<ul>
<li>Figure out how to read the blockchain from disk (the Bitcoin core format).</li>
<li>Import it into Postgres.</li>
<li>See how much of it can be validated in Postgres itself.</li>
<li>See if we can fill-in the missing functionality to make Postgres fully
capable of verifying a transaction? Unless I come up with something more
interesting to do.</li>
<li>???</li>
<li>Profit!</li>
</ul>
<p>Oh, and of course we&rsquo;re doing all this in Go. (What else?)</p>
<h4 id="has-anyone-done-this">Has anyone done this?<a hidden class="anchor" aria-hidden="true" href="#has-anyone-done-this">#</a></h4>
<ul>
<li>
<p><a href="https://github.com/bitcoin-abe/bitcoin-abe">Abe</a> - while I suspect
most people use it with MySQL, it does have fully functional
Postgres support. It&rsquo;s written in Python, and the blockchain import
is likely to take a week or more these days.</p>
</li>
<li>
<p>btcd and gocoin are Golang examples</p>
<p>Btcd is a pretty widely used Go implementation of a node. It uses a
different on-disk format.</p>
<p>Gocoin is another Go implementation. It&rsquo;s an unusual project in that
the author does not accept pull requests.</p>
</li>
<li>
<p>the MS SQL-SERVER thing</p>
<p><a href="https://github.com/ladimolnar/BitcoinDatabaseGenerator">https://github.com/ladimolnar/BitcoinDatabaseGenerator</a></p>
</li>
</ul>
<h4 id="main-components">Main Components<a hidden class="anchor" aria-hidden="true" href="#main-components">#</a></h4>
<ul>
<li>Blocks</li>
<li>Transactions</li>
<li>Inputs</li>
<li>Outputs</li>
</ul>
<h4 id="data-types">Data Types<a hidden class="anchor" aria-hidden="true" href="#data-types">#</a></h4>
<ul>
<li>bytea</li>
<li>bigint (because unsigned)</li>
</ul>
<h4 id="other">Other<a hidden class="anchor" aria-hidden="true" href="#other">#</a></h4>
<ul>
<li>Where are</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Gregory Trubetskoy</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
